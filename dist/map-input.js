/*! @maps4html/web-map-custom-element 01-10-2023 */

import{ZoomInput}from"./zoomInput.js";import{HiddenInput}from"./hiddenInput.js";import{WidthInput}from"./widthInput.js";import{HeightInput}from"./heightInput.js";import{LocationInput}from"./locationInput.js";class MapInput extends HTMLElement{static get observedAttributes(){return["name","type","value","axis","units","position","rel","min","max","step"]}get name(){return this.getAttribute("name")}set name(t){t&&this.setAttribute("name",t)}get type(){return this.getAttribute("type")}set type(t){["location"].includes(t)&&this.setAttribute("type",t)}get value(){return this.input.getValue()}set value(t){t&&this.setAttribute("value",t)}get axis(){return this.getAttribute("axis")}set axis(t){t&&this.setAttribute("axis",t)}get units(){return this.getAttribute("units")}set units(t){t&&this.setAttribute("units",t)}get position(){return this.getAttribute("position")}set position(t){t&&this.setAttribute("position",t)}get rel(){return this.getAttribute("rel")}set rel(t){t&&this.setAttribute("rel",t)}get min(){return"height"===this.type||"width"===this.type||"hidden"===this.type?null:this.getAttribute("min")?this.getAttribute("min"):this._layer._layerEl.querySelector("map-meta[name=zoom]")?M._metaContentToObject(this._layer._layerEl.querySelector("map-meta[name=zoom]").getAttribute("content")).min:this._layer._layerEl.extent.zoom.minZoom.toString()}set min(t){t&&this.setAttribute("min",t)}get max(){return"height"===this.type||"width"===this.type||"hidden"===this.type?null:this.getAttribute("max")?this.getAttribute("max"):this._layer._layerEl.querySelector("map-meta[name=zoom]")?M._metaContentToObject(this._layer._layerEl.querySelector("map-meta[name=zoom]").getAttribute("content")).max:this._layer._layerEl.extent.zoom.maxZoom.toString()}set max(t){t&&this.setAttribute("max",t)}get step(){return"zoom"!==this.type?null:this.getAttribute("step")||"1"}set step(t){t&&this.setAttribute("step",t)}attributeChangedCallback(t,e,i){switch(t){case"name":e!==i&&null!==e&&(this.input.name=i);break;case"type":break;case"value":e!==i&&(null!==e?this.input.value=i:this.initialValue=i);break;case"axis":e!==i&&this.input&&(this.input.axis=i);break;case"units":e!==i&&this.input&&(this.input.units=i);break;case"position":e!==i&&this.input&&(this.input.position=i);break;case"rel":e!==i&&this.input&&(this.input.rel=i);break;case"min":e!==i&&this.input&&(this.input.min=i);break;case"max":e!==i&&this.input&&(this.input.max=i);break;case"step":e!==i&&this.input&&(this.input.step=i)}}constructor(){super()}async connectedCallback(){switch(await this.parentElement.whenReady(),"MAP-EXTENT"===this.parentElement.nodeName&&(this._layer=this.parentElement._layer),this.type){case"zoom":this.input=new ZoomInput(this.name,this.min,this.max,this.initialValue,this.step,this._layer);break;case"location":this.input=new LocationInput(this.name,this.position,this.axis,this.units,this.min,this.max,this.rel,this._layer),L.DomEvent.on(this.parentElement._layer._map,"click",this._query,this);break;case"width":this.input=new WidthInput(this.name,this._layer);break;case"height":this.input=new HeightInput(this.name,this._layer);break;case"hidden":this.input=new HiddenInput(this.name,this.initialValue)}}disconnectedCallback(){}_query(t){this.input.clicki=t.latlng.lat,this.input.clickj=t.latlng.lng}checkValidity(){if(this.input.validateInput())return!0;var t=new Event("invalid",{bubbles:!0,cancelable:!0,composed:!0});return this.dispatchEvent(t),!1}reportValidity(){if(this.input.validateInput())return!0;var t=new Event("invalid",{bubbles:!0,cancelable:!0,composed:!0});return this.dispatchEvent(t),console.log("Input type='"+this.type+"' is not valid!"),!1}whenReady(){return new Promise((e,t)=>{let i,n;this.input?e():(i=setInterval(function(t){t.input&&(clearInterval(i),clearTimeout(n),e())},300,this),n=setTimeout(function(){clearInterval(i),clearTimeout(n),t("Timeout reached waiting for input to be ready")},1e4))})}}export{MapInput};
//# sourceMappingURL=map-input.js.map